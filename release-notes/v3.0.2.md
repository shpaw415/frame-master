# Frame Master v3.0.2

**Release Date:** December 11, 2025

This patch release fixes two issues related to virtual modules in the build system.

---

## Bug Fixes

### Plugin Chaining: Virtual Module Support

Fixed an issue where plugin chaining would throw `ENOENT` errors when processing virtual modules.

**The Problem:**
When multiple plugins registered `onLoad` handlers and one of them created a virtual module via `onResolve`, the chaining system would attempt to read the virtual path from disk, causing:

```
ENOENT: no such file or directory, open 'virtual-module-path-name'
```

**The Fix:**
`getChainableContent()` and `getChainableBinaryContent()` now properly detect virtual modules by checking the namespace. For non-file namespaces, they return empty content instead of attempting disk reads:

```typescript
// Virtual modules are detected by their namespace
const isFileNamespace = !args.namespace || args.namespace === "file";
if (!isFileNamespace) {
  return ""; // Don't attempt disk read for virtual modules
}
```

---

### DirectiveTool: Graceful Handling of Non-Existent Files

Fixed an issue where `DirectiveTool.pathIs()` would throw when checking directives on virtual modules or non-existent files.

**The Problem:**
When a global `onLoad` handler used `directiveToolSingleton.pathIs()` to check for directives like `"server-only"`, it would crash on virtual modules:

```typescript
build.onLoad({ filter: /.*/ }, async (args) => {
  // This would throw for virtual modules like "client-routes"
  const isServerOnly = await directiveToolSingleton.pathIs(
    "server-only",
    args.path
  );
});
```

**The Fix:**
`detectDirective()` now checks if the file exists before attempting to read it:

```typescript
private async detectDirective(filePath: string): Promise<string> {
  const file = Bun.file(filePath);
  if (!(await file.exists())) return "use-server";
  // ... rest of detection logic
}
```

---

## Upgrade

```bash
bun update frame-master
```

No breaking changes. This is a drop-in replacement for v3.0.1.
